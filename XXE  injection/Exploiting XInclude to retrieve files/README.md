## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/f826139a-ba81-471e-912f-ddee5dea9cb5)

## Solution :

#### XInclude attacks
 
 Some applications receive client-submitted data, embed it on the server-side into an XML document, and then parse the document. An example of this occurs when client-submitted data is placed into a back-end SOAP request, which is then processed by the backend SOAP service.

In this situation, y**ou cannot carry out a classic XXE attack, because you don't control the entire XML document and so cannot define or modify a DOCTYPE element**. However, you might be able to use XInclude.

**XInclude is a part of the XML specification that allows an XML document to be built from sub-documents**. You can place an XInclude attack within any data value in an XML document, so the _attack can be performed in situations where you only control a single item of data that is placed into a server-side XML document_.

To test for XInclude attacks, insert the following payload into the data entry point and see if the file that you requested gets sent back in the response body:

```xml
<example xmlns:xi="http://www.w3.org/2001/XInclude">
 <xi:include parse="text" href="file:///etc/hostname"/>
</example>
```
> This piece of XML code does two things. First, it references the http://www.w3.org/2001/XInclude namespace so that we can use the `xi:include element. Next, it uses that element to parse and
> include the `/etc/hostname` file in the XML document


Visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/7a4519e6-dee5-4364-8354-cb921667952b)

Set the value of the productId parameter to:

```xml
<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>
```

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/1b3db3e7-ea83-4e78-b18d-0ae2dc68e7fa)

Lab Solved.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/1325c835-2a73-4b85-b932-3c4ab962715d)


